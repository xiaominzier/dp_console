<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>公司信息详情</title>
    <link rel="stylesheet" href="/staticResource/css/font.css">
    <link rel="stylesheet" href="/staticResource/css/xadmin.css">
    <style>
        .base-info-title {
            text-align: right;
            font-weight: bold;
        }

        .imp-item {
            padding: 9px;
        }

        .imp-item a {
            color: blue;
        }
    </style>
</head>
<body style="background-color: #fff;height: 100%;padding: 10px;">
<form class="layui-form layui-col-space5">
    <div class="layui-fluid">
        <div class="layui-row layui-col-space15">
            <div class="layui-col-md12">
                <div class="layui-card">
                    <div class="layui-card-header" style="text-align: right;">
                        <button class="layui-btn layui-btn-danger" id="cancelbtn" lay-filter="cancel"><i
                                class="layui-icon">&#x1006;</i>关闭
                        </button>
                    </div>
                    <div class="layui-card-body ">
                        <h1>公司详情</h1>
                        <!--公司信息开始-->
                        <table class="layui-table" lay-skin="nob">
                            <tbody id="companyInfo">

                            </tbody>
                        </table>
                        <!--公司信息结束-->
                        <!--公司固定字段开始-->
                        <fieldset class="layui-elem-field">
                            <legend>基本信息</legend>
                            <div class="layui-field-box">
                                <table class="layui-table" lay-skin="nob">
                                    <tbody id="baseFieldInfo">

                                    </tbody>
                                </table>
                            </div>
                        </fieldset>
                        <!--公司固定字段结束-->
                        <!--公司动态字段开始-->
                        <div class="layui-tab layui-tab-card" lay-filter="dynFieldInfo" id="dynFieldInfo"
                             style="margin-top: 0px;">
                            <ul class="layui-tab-title" id="tabTitle">
                            </ul>
                            <div class="layui-tab-content" style="min-height: 800px;" id="tabContent">
                            </div>
                        </div>
                        <!--公司动态字段结束-->
                        <!--公司其他信息开始-->
                        <fieldset class="layui-elem-field">
                            <legend>其他</legend>
                            <div class="layui-field-box" id="otherInfos">
                            </div>
                        </fieldset>
                        <!--公司其他信息结束-->
                        <div class="layui-card-header" style="text-align: right;">
                            <button class="layui-btn" id="imporveBtn" type="button" lay-filter="imporve"><i
                                    class="layui-icon">&#xe605;</i>完善
                            </button>
                            <button class="layui-btn layui-btn-danger" type="button" id="cancelbtn1"
                                    lay-filter="cancel"><i
                                    class="layui-icon">&#x1006;</i>关闭
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
<script type="text/javascript" src="/staticResource/lib/jsencrypt/jsencrypt.js"></script>
<script type="text/javascript" src="/staticResource/lib/jsencrypt/aes.mini.js"></script>
<script type="text/javascript" src="/staticResource/lib/common-js/jquery.min.js"></script>
<script src="/staticResource/lib/layui/layui.js" charset="utf-8"></script>
<script src="/staticResource/lib/common-js/xadmin.js" charset="utf-8"></script>
<script src="/staticResource/lib/common-js/util.js"></script>

<script>
    Array.prototype.push2 = function () {
        for (var i = 0; i < arguments.length; i++) {
            var ele = arguments[i];
            if (this.indexOf(ele) == -1) {
                this.push(ele);
            }
        }
    };
    var fid = getParam("fid");
    var id = getParam("id");
    var companyDtoInfo;
    //违规等级信息
    var levelOptions = [{name: "不违规", value: 3}, {name: "违规", value: 2}, {name: "一般违规", value: 1}, {
        name: "严重违规",
        value: 0
    }];
    var industryLevelOptions = [{name: "默认", value: 0}, {name: "低", value: 1}, {name: "中", value: 2}, {
        name: "高",
        value: 3
    }];

    function delWorkImg(btnId) {
        var delBtn = $("#" + btnId);
        var fileuploadId = delBtn.data("fileuploadid");
        //console.log(fileuploadId);
        if (companyDtoInfo) {
            var impCompanyPictures = companyDtoInfo.impCompanyPictures;
            if (impCompanyPictures) {
                let delIndex;
                for (var index in impCompanyPictures) {
                    if (impCompanyPictures[index].fileuploadId == fileuploadId) {
                        delIndex = index;
                        break;
                    }
                }
                if (delIndex) {
                    impCompanyPictures.splice(delIndex, 1);
                }
            }
            delBtn.parent().remove();
        }

    }

    function delCompanyPaln(planFileId, rectificationPlanId) {
        //console.log("delCompanyPaln------------")
        //console.log(planFileId)
        $("#" + planFileId).remove();
        var delIndex;
        if (companyDtoInfo) {
            for (var planIndex in companyDtoInfo.impCompanyPlanRelations) {
                if (isNaN(planIndex) == false) {
                    if (impCompanyPlanRelations[planIndex].rectificationPlanId == rectificationPlanId) {
                        delIndex = planIndex;
                        break;
                    }
                }
            }
            if (delIndex && companyDtoInfo.impCompanyPlanRelations) {
                companyDtoInfo.impCompanyPlanRelations.splice(delIndex, 1);
            }
        }
    }

    $(function () {
        if (id && id != null) {
            var url = apiPath + "/company/impCompanyInfo/getCompanyDto/" + id;
            $.ajax({
                type: "GET",
                url: url,
                success: function (res) {
                    if (res.code == 0) {

                        layui.config({
                            base: "/staticResource/lib/layui/lay/modules/"
                        }).use(['layer', 'element', 'form', 'laydate', 'upload'], function () {
                            layer = layui.layer;
                            element = layui.element;
                            form = layui.form;
                            laydate = layui.laydate;
                            upload = layui.upload;
                            companyDtoInfo = res.data;
                            var data = res.data;
                            disComanyInfo(data);
                            showBaseField(data);
                            showDynField(data);
                            // 公司照片
                            var companyImags = new Array();
                            //现场照片
                            var siteImags = new Array();
                            //工作照片
                            var workImags = new Array();
                            var impCompanyPictures = data.impCompanyPictures;
                            if (impCompanyPictures) {
                                var impCompanyPicture;
                                for (var index in impCompanyPictures) {
                                    if (isNaN(index) == false) {
                                        impCompanyPicture = impCompanyPictures[index];
                                        // 公司图片类型   1：工作照 2：现场图片3：企业执照
                                        if (impCompanyPicture.type == "1") {
                                            workImags.push({
                                                path: apiPath + "/attached/show/" + impCompanyPicture.fileuploadId,
                                                uploadId: impCompanyPicture.fileuploadId
                                            });
                                        } else if (impCompanyPicture.type == "2") {
                                            siteImags.push({
                                                path: apiPath + "/attached/show/" + impCompanyPicture.fileuploadId,
                                                uploadId: impCompanyPicture.fileuploadId
                                            });
                                        } else if (impCompanyPicture.type == "3") {
                                            var licenseType = impCompanyPicture.licenseType;
                                            var licenseTypeStr = "";
                                            // 营业执照:1 排污许可证:2 应急预案:3 食品经营许可证:4  维修经营许可证:5  医疗机构执业许可证:6
                                            if (licenseType == 1) {
                                                licenseTypeStr = "营业执照";
                                            } else if (licenseType == 2) {
                                                licenseTypeStr = "排污许可证";
                                            } else if (licenseType == 3) {
                                                licenseTypeStr = "应急预案";
                                            } else if (licenseType == 4) {
                                                licenseTypeStr = "食品经营许可证";
                                            } else if (licenseType == 5) {
                                                licenseTypeStr = "维修经营许可证";
                                            } else if (licenseType == 6) {
                                                licenseTypeStr = "医疗机构执业许可证";
                                            } else {
                                                licenseTypeStr = "自定义";
                                            }
                                            companyImags.push({
                                                type: licenseType,
                                                name: licenseTypeStr,
                                                src: apiPath + "/attached/show/" + impCompanyPicture.fileuploadId
                                            })
                                        }
                                    }
                                }
                            }
                            var otherInfos = $("#otherInfos");
                            //显示企业执照信息。
                            var companyLicenseIds = "companyLicenseImgs";
                            var companyLicenseStr = "<fieldset class=\"layui-elem-field\">\n" +
                                "                            <legend>企业执照</legend>\n" +
                                "                            <div class=\"layui-field-box\">\n" +
                                "<div class=\" layui-photos-demo\" id=\"" + companyLicenseIds + "\" style=\"padding: 7px;\">\n";
                            var licenseTypeArr = [{name: "营业执照", value: "1"}, {
                                name: "排污许可证",
                                value: "2"
                            }, {name: "应急预案", value: "3"}, {name: "食品经营许可证", value: "4"}, {
                                name: "维修经营许可证",
                                value: "5"
                            }, {name: "医疗机构执业许可证", value: "6"}];
                            for (var imgIndex in companyImags) {
                                if (isNaN(imgIndex) == false) {
                                    companyLicenseStr += "<div class=\"layui-upload\">\n" +
                                        "  <div class=\"layui-upload-list\">\n" +
                                        "    <img style='width: 90px;' class=\"layui-upload-img\" id=\"licenseType_img_" + companyImags[imgIndex].name + "\" layer-src = \"" + companyImags[imgIndex].src + "\" layer-pid src=\"" + companyImags[imgIndex].src + "\" alt=\"" + companyImags[imgIndex].name + "\" layer-index = \"" + index + "\">\n" +
                                        "    <p id=\"demoText\"></p>\n" +
                                        "  </div>\n" +
                                        "  <button type=\"button\" class=\"layui-btn\ lic_upload\" id=\"licenseType_upload_" + companyImags[imgIndex].name + "\">" + companyImags[imgIndex].name + "</button>\n" +
                                        "</div>  ";
                                }
                            }
                            companyLicenseStr += "</div>\n" +
                                "</div>\n" +
                                "</fieldset>\n";
                            otherInfos.append($(companyLicenseStr));
                            for (var imgIndex in companyImags) {
                                if (isNaN(imgIndex) == false) {
                                    let companyImagName = companyImags[imgIndex].name;
                                    let companyImagType = companyImags[imgIndex].type;
                                    upload.render({
                                        elem: '#licenseType_upload_' + companyImagName
                                        , url: apiPath + '/attached/file_upload'
                                        , before: function (obj) {
                                            //预读本地文件示例，不支持ie8
                                            obj.preview(function (index, file, result) {
                                                //console.log("0------------")
                                                //console.log('#licenseType_img_' + companyImagName)
                                                //console.log(result)
                                                $('#licenseType_img_' + companyImagName).attr('src', result); //图片链接（base64）
                                            });
                                        }
                                        , done: function (res) {
                                            //如果上传失败
                                            if (res.code > 0) {
                                                return top.layer.msg('上传失败');
                                            }
                                            //上传成功
                                            if (res && res.code == 0) {
                                                top.layer.msg('上传成功');
                                                var impCompanyPictures = data.impCompanyPictures;
                                                if (impCompanyPictures) {
                                                    var impCompanyPicture;
                                                    for (var index in impCompanyPictures) {
                                                        if (isNaN(index) == false) {
                                                            impCompanyPicture = impCompanyPictures[index];
                                                            if (impCompanyPicture.licenseType == companyImagType) {
                                                                impCompanyPicture.fileuploadId = res.data;
                                                                break;
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    })
                                }
                            }
                            photoIds.push(companyLicenseIds);
                            // 显示处罚记录
                            var publishStr = "<fieldset class=\"layui-elem-field\">\n" +
                                "                            <legend>处罚记录</legend>\n" +
                                "                            <div class=\"layui-field-box\">\n";
                            var impCompanyPunishRecords = data.impCompanyPunishRecords;
                            if (impCompanyPunishRecords) {
                                for (var index in impCompanyPunishRecords) {
                                    if (isNaN(index) == false) {
                                        var impCompanyPunishRecord = impCompanyPunishRecords[index];
                                        var punishTimeStr = "-";
                                        if (impCompanyPunishRecord.punishTime != null && impCompanyPunishRecord.punishTime != undefined && impCompanyPunishRecord.punishTime > 0) {
                                            punishTimeStr = new Date(impCompanyPunishRecord.punishTime).format("yyyy-MM-dd hh:mm:ss");
                                        }
                                        var solveStr = "否";
                                        if (impCompanyPunishRecord.solve != undefined) {
                                            solveStr = impCompanyPunishRecord.solve == 0 ? "否" : "是";
                                        }
                                        getDisStr2(impCompanyPunishRecord.solve)
                                        publishStr += "<fieldset class=\"layui-elem-field\">\n" +
                                            "                            <legend>处罚记录</legend>\n" +
                                            "                            <div class=\"layui-field-box\">\n" +
                                            "<table class=\"layui-table\" lay-skin=\"nob\" style='width: 48%;float: left;'>\n" +
                                            "<tbody><tr>" +
                                            "   <td width=\"15%\" class=\"base-info-title\">处罚项目</td>\n" +
                                            "   <td width=\"35%\">" +
                                            "   " + getDisStr2(impCompanyPunishRecord.punishProject) +
                                            "</td></tr></tbody></table>\n" +
                                            "<table class=\"layui-table\" lay-skin=\"nob\" style='width: 48%;float: left;'>\n" +
                                            "<tbody><tr>" +
                                            "   <td width=\"15%\" class=\"base-info-title\">处罚原因</td>\n" +
                                            "   <td width=\"35%\">" +
                                            "   " + getDisStr2(impCompanyPunishRecord.punishReason) +
                                            "</td></tr></tbody></table>\n" +
                                            "<table class=\"layui-table\" lay-skin=\"nob\" style='width: 48%;float: left;'>\n" +
                                            "<tbody><tr>" +
                                            "   <td width=\"15%\" class=\"base-info-title\">处罚机构</td>\n" +
                                            "   <td width=\"35%\">" +
                                            "   " + getDisStr2(impCompanyPunishRecord.punishMechanism) +
                                            "</td></tr></tbody></table>\n" +
                                            "<table class=\"layui-table\" lay-skin=\"nob\" style='width: 48%;float: left;'>\n" +
                                            "<tbody><tr>" +
                                            "   <td width=\"15%\" class=\"base-info-title\">处罚时间</td>\n" +
                                            "   <td width=\"35%\">" +
                                            "   " + punishTimeStr +
                                            "</td></tr></tbody></table>\n" +
                                            "<table class=\"layui-table\" lay-skin=\"nob\" style='width: 48%;float: left;'>\n" +
                                            "<tbody><tr>" +
                                            "   <td width=\"15%\" class=\"base-info-title\">是否解决</td>\n" +
                                            "   <td width=\"35%\">" +
                                            "   " + solveStr +
                                            "</td></tr></tbody></table>\n" +
                                            "<table class=\"layui-table\" lay-skin=\"nob\" style='width: 48%;float: left;'>\n" +
                                            "<tbody><tr>" +
                                            "   <td width=\"15%\" class=\"base-info-title\">解决方式</td>\n" +
                                            "   <td width=\"35%\">";
                                        var solveTypeStr = "";
                                        if (solveStr == "是") {
                                            if (impCompanyPunishRecord.solveType) {
                                                // 缴纳罚款:0  处罚撤销:1 其他:2
                                                if (impCompanyPunishRecord.solveType == 0) {
                                                    solveTypeStr = "缴纳罚款";
                                                } else if (impCompanyPunishRecord.solveType == 1) {
                                                    solveTypeStr = "处罚撤销";
                                                } else if (impCompanyPunishRecord.solveType == 2) {
                                                    solveTypeStr = "其他:" + impCompanyPunishRecord.solveTypeData;
                                                }
                                            }
                                        }

                                        publishStr += solveTypeStr + "</td></tr></tbody></table>\n" +
                                            "      </div>\n" +
                                            "  </fieldset>";
                                    }
                                }
                            }
                            publishStr += "      </div>\n" +
                                "  </fieldset>"

                            otherInfos.append($(publishStr));

                            var siteConditions;
                            if (data.impCompanyOtherInfo.siteConditions) {
                                siteConditions = data.impCompanyOtherInfo.siteConditions;
                            }
                            var workContent;
                            if (data.impCompanyOtherInfo.workContent) {
                                workContent = data.impCompanyOtherInfo.workContent;
                            }
                            var remarks;
                            if (data.impCompanyOtherInfo.remarks) {
                                remarks = data.impCompanyOtherInfo.remarks;
                            }
                            var latitudeLongitude;
                            if (data.latitudeLongitude) {
                                latitudeLongitude = data.latitudeLongitude;
                            }
                            //现场图片
                            var siteInfos = "<fieldset class=\"layui-elem-field\">\n" +
                                "                            <legend>现场图片</legend>\n" +
                                "                            <div class=\"layui-field-box\" id=\"otherInfos\">\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td width=\"15%\" class=\"base-info-title\">现场情况</td>\n" +
                                "   <td>" +
                                "   <textarea id='siteConditions_textarea' class='layui-textarea'>" + getDisStr1(siteConditions) + "</textarea>" +
                                "</td></tr></tbody></table>\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td width=\"15%\" class=\"base-info-title\">现场图片</td>\n" +
                                "   <td>" +
                                "<div class=\"layui-upload\">\n" +
                                "  <blockquote class=\"layui-elem-quote layui-quote-nm\" style=\"margin-top: 10px;\">\n";
                            var imgId = "layui-photos-demo-" + Math.random();
                            siteInfos += " <div class=\" layui-photos-demo\" id=\"" + imgId + "\" style=\"padding: 7px;\">\n";
                            for (var imgIndex in siteImags) {
                                if (isNaN(imgIndex) == false) {
                                    var btnId = "id_" + parseInt(Math.random() * 100000) + new Date().getTime();
                                    siteInfos += " <span><img layer-src = \"" + siteImags[imgIndex].path + "\" layer-pid src=\"" + siteImags[imgIndex].path + "\" alt=\"\" layer-index = \"" + imgIndex + "\"><a href='javascript:delWorkImg(\"" + btnId + "\")' id='" + btnId + "' data-fileuploadid='" + siteImags[imgIndex].uploadId + "'>删除</a></span>\n";
                                }
                            }
                            siteInfos += "</div>  " +
                                "    <button type=\"button\" class=\"layui-btn\" id=\"site_img_upload_\">图片上传</button> \n" +
                                " </blockquote>\n" +
                                "</div>" +
                                "</td></tr></tbody></table>\n" +
                                "                            </div>\n" +
                                "                        </fieldset>";
                            otherInfos.append($(siteInfos));
                            photoIds.push(imgId);
                            upload.render({
                                elem: '#site_img_upload_'
                                , url: apiPath + '/attached/file_upload'
                                , before: function (obj) {
                                    //预读本地文件示例，不支持ie8
                                    obj.preview(function (index, file, result) {
                                    });
                                }
                                , done: function (res) {
                                    //如果上传失败
                                    if (res.code > 0) {
                                        return top.layer.msg('上传失败');
                                    }
                                    //上传成功
                                    if (res && res.code == 0) {
                                        top.layer.msg('上传成功');
                                        var impCompanyPictures = data.impCompanyPictures;
                                        if (impCompanyPictures == undefined || impCompanyPictures == null) {
                                            impCompanyPictures = new Array();
                                            data.impCompanyPictures = impCompanyPictures;
                                        }

                                        var btnId = "id_" + parseInt(Math.random() * 100000) + new Date().getTime();
                                        $('#' + imgId).append("<span><img layer-src = \"" + apiPath + "/attached/show/" + res.data + "\" layer-pid src=\"" + apiPath + "/attached/show/" + res.data + "\" alt=\"\" \"><a  href='javascript:delWorkImg(\"" + btnId + "\")' id='" + btnId + "' data-fileuploadid='" + res.data + "'>删除</a></span>");

                                        impCompanyPictures.push({
                                            "companyId": id,
                                            "fileuploadId": res.data,
                                            "type": "2",
                                            "createTime": new Date().getTime(),
                                            "updateTime": new Date().getTime()
                                        });
                                    }
                                }
                            })
                            Object.defineProperty(data.impCompanyOtherInfo, "bindSiteConditions", {
                                configurable: true,
                                get: function () {
                                    return this.siteConditions;
                                },
                                set: function (val) {
                                    this.siteConditions = val;
                                }
                            })
                            $("#siteConditions_textarea").on("input", function (e) {
                                data.impCompanyOtherInfo.bindSiteConditions = this.value;
                            })
                            //工作照
                            var workInfos = "<fieldset class=\"layui-elem-field\">\n" +
                                "                            <legend>工作照</legend>\n" +
                                "                            <div class=\"layui-field-box\" id=\"otherInfos\">\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td width=\"15%\" class=\"base-info-title\">工作内容</td>\n" +
                                "   <td>" +
                                "   <textarea id='workContent_textarea' class='layui-textarea'>" + getDisStr1(workContent) + "</textarea>" +
                                "</td></tr></tbody></table>\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td width=\"15%\" class=\"base-info-title\">工作照</td>\n" +
                                "   <td>" +
                                "<div class=\"layui-upload\">\n" +
                                "  <blockquote class=\"layui-elem-quote layui-quote-nm\" style=\"margin-top: 10px;\">\n";
                            var imgId = "layui-photos-demo" + Math.random();
                            workInfos += " <div class=\" layui-photos-demo\" id=\"" + imgId + "\" style=\"padding: 7px;\">\n";
                            for (var imgIndex in workImags) {
                                if (isNaN(imgIndex) == false) {
                                    var btnId = "id_" + parseInt(Math.random() * 100000) + new Date().getTime();
                                    workInfos += "<span><img layer-src = \"" + workImags[imgIndex].path + "\" layer-pid src=\"" + workImags[imgIndex].path + "\" alt=\"\" layer-index = \"" + imgIndex + "\"><a href='javascript:delWorkImg(\"" + btnId + "\")' id='" + btnId + "' data-fileuploadid='" + workImags[imgIndex].uploadId + "'>删除</a></span>\n";
                                }
                            }
                            workInfos += "</div>  " +
                                "    <button type=\"button\" class=\"layui-btn\" id=\"word_img_upload_\">图片上传</button> \n" +
                                " </blockquote>\n" +
                                "</div>" +
                                "</td></tr></tbody></table>\n" +
                                "                            </div>\n" +
                                "                        </fieldset>";
                            otherInfos.append($(workInfos));
                            photoIds.push(imgId);
                            upload.render({
                                elem: '#word_img_upload_'
                                , url: apiPath + '/attached/file_upload'
                                , before: function (obj) {
                                    //预读本地文件示例，不支持ie8
                                    obj.preview(function (index, file, result) {
                                    });
                                }
                                , done: function (res) {
                                    //如果上传失败
                                    if (res.code > 0) {
                                        return top.layer.msg('上传失败');
                                    }
                                    //上传成功
                                    if (res && res.code == 0) {
                                        top.layer.msg('上传成功');
                                        var impCompanyPictures = data.impCompanyPictures;
                                        if (impCompanyPictures == undefined || impCompanyPictures == null) {
                                            impCompanyPictures = new Array();
                                            data.impCompanyPictures = impCompanyPictures;
                                        }
                                        var btnId = "id_" + parseInt(Math.random() * 100000) + new Date().getTime();
                                        $('#' + imgId).append("<span><img layer-src = \"" + apiPath + "/attached/show/" + res.data + "\" layer-pid src=\"" + apiPath + "/attached/show/" + res.data + "\" alt=\"\" \"><a  href='javascript:delWorkImg(\"" + btnId + "\")' id='" + btnId + "' data-fileuploadid='" + res.data + "'>删除</a></span>");

                                        impCompanyPictures.push({
                                            "companyId": id,
                                            "fileuploadId": res.data,
                                            "type": "1",
                                            "createTime": new Date().getTime(),
                                            "updateTime": new Date().getTime()
                                        });
                                    }
                                }
                            })
                            Object.defineProperty(data.impCompanyOtherInfo, "bindWorkContent", {
                                configurable: true,
                                get: function () {
                                    return this.workContent;
                                },
                                set: function (val) {
                                    this.workContent = val;
                                }
                            })
                            $("#workContent_textarea").on("input", function (e) {
                                data.impCompanyOtherInfo.bindWorkContent = this.value;
                            })
                            // 其他
                            var otherChildInfos = "<fieldset class=\"layui-elem-field\">\n" +
                                "                            <legend>其他</legend>\n" +
                                "                            <div class=\"layui-field-box\" id=\"otherInfos\">\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td width=\"15%\" class=\"base-info-title\">备注</td>\n" +
                                "   <td>" +
                                "   <textarea id='remarks_textarea' class='layui-textarea'>" + getDisStr1(remarks) + "</textarea>" +
                                "</td></tr></tbody></table>\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td width=\"15%\" class=\"base-info-title\">企业签字</td>\n" +
                                "   <td>";
                            var signImgPath = "";
                            if (data.impCompanyOtherInfo && data.impCompanyOtherInfo.sign) {
                                signImgPath = apiPath + "/attached/show/" + data.impCompanyOtherInfo.sign;
                            }
                            var imgId = "layui-photos-demo" + Math.random();
                            otherChildInfos += "<div class=\"layui-upload\">\n" +
                                "  <div class=\"layui-upload-list\" id=\"" + imgId + "\">\n" +
                                "    <img class=\"layui-upload-img\" id='impCompanyOtherInfo_img'   layer-src = \"" + signImgPath + "\" layer-pid src=\"" + signImgPath + "\"   layer-index = \"" + index + "\">\n" +
                                "    <p id=\"demoText\"></p>\n" +
                                "  </div>\n" +
                                "  <button type=\"button\" class=\"layui-btn\ lic_upload\" id=\"impCompanyOtherInfo_upload_\">企业签字</button>\n" +
                                "</td>" +
                                "   </tr><tr><td width=\"15%\" class=\"base-info-title\">经纬度</td>\n" +
                                "<td>" +
                                "  <input id='latitudeLongitude'   autocomplete=\"off\" class=\"layui-input\" value='" + latitudeLongitude + "'>\n" +
                                "</td>" +
                                "</tr></tbody></table>\n" +
                                "                            </div>\n" +
                                "                        </fieldset>";
                            otherInfos.append($(otherChildInfos));
                            photoIds.push(imgId);
                            upload.render({
                                elem: '#impCompanyOtherInfo_upload_'
                                , url: apiPath + '/attached/file_upload'
                                , before: function (obj) {
                                    //预读本地文件示例，不支持ie8
                                    obj.preview(function (index, file, result) {
                                        $('#impCompanyOtherInfo_img').attr('src', result); //图片链接（base64）
                                    });
                                }
                                , done: function (res) {
                                    //如果上传失败
                                    if (res.code > 0) {
                                        return top.layer.msg('上传失败');
                                    }
                                    //上传成功
                                    if (res && res.code == 0) {
                                        top.layer.msg('上传成功');
                                        data.impCompanyOtherInfo.sign = res.data;
                                    }
                                }
                            })

                            Object.defineProperty(data.impCompanyOtherInfo, "bindRemarks", {
                                configurable: true,
                                get: function () {
                                    return this.remarks;
                                },
                                set: function (val) {
                                    this.remarks = val;
                                }
                            })
                            $("#remarks_textarea").on("input", function (e) {
                                data.impCompanyOtherInfo.bindRemarks = this.value;
                                //console.log(data.impCompanyOtherInfo)
                            })
                            Object.defineProperty(data, "bindLatitudeLongitude", {
                                configurable: true,
                                get: function () {
                                    return this.latitudeLongitude;
                                },
                                set: function (val) {
                                    this.latitudeLongitude = val;
                                }
                            })
                            $("#latitudeLongitude").on("input", function (e) {
                                data.bindLatitudeLongitude = this.value;
                            })
                            // fileName、rectificationPlanId
                            //方案信息
                            var impCompanyPlanRelations = data.impCompanyPlanRelations;
                            var fileStr = "";
                            if (impCompanyPlanRelations) {
                                for (var index in impCompanyPlanRelations) {
                                    if (isNaN(index) == false) {
                                        var planFileId = "planFileId_" + parseInt(Math.random() * 1000000) + new Date().getTime();
                                        var impCompanyPlanRelation = impCompanyPlanRelations[index];
                                        fileStr += "<div id='" + planFileId + "'>" + impCompanyPlanRelation.fileName + "&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:delCompanyPaln('" + planFileId + "','" + impCompanyPlanRelation.rectificationPlanId + "')\">删除</a></div>";
                                    }
                                }
                            }
                            var planContainerId = "planContainer_" + parseInt(Math.random() * 1000000) + new Date().getTime();
                            var planUPloadFileBtnId = "planContainer_" + parseInt(Math.random() * 1000000) + new Date().getTime();
                            var rectificationPlanHtml = "<fieldset class=\"layui-elem-field\">\n" +
                                "                            <legend>整改方案</legend>\n" +
                                "                            <div class=\"layui-field-box\">\n" +
                                "<table class=\"layui-table\" lay-skin=\"nob\" style='float: left;'>\n" +
                                "<tbody><tr>" +
                                "   <td class=\"base-info-title\" style='width: 100px;'>整改方案附件</td>\n" +
                                "   <td id='" + planContainerId + "'>" + fileStr + "</td>" +
                                "</tr>" +
                                "<tr>" +
                                "   <td><button type=\"button\" class=\"layui-btn\" id=\"" + planUPloadFileBtnId + "\">上传附件</button> </td>" +
                                "</tr></tbody></table>\n" +
                                "</div>\n" +
                                "</fieldset>";

                            otherInfos.append($(rectificationPlanHtml));
                            upload.render({
                                elem: '#' + planUPloadFileBtnId
                                , multiple: true
                                , accept: 'file'
                                , url: apiPath + '/attached/file_upload' //改成您自己的上传接口
                                , choose: function (obj) {
                                    //将每次选择的文件追加到文件队列
                                    obj.preview(function (index, file, result) {
                                        //console.log(index); //得到文件索引
                                        //console.log(file); //得到文件对象
                                        //console.log(result); //得到文件base64编码，比如图片
                                        localStorage.setItem("filename", file.name);
                                        //obj.resetFile(index, file, '123.jpg'); //重命名文件名，layui 2.3.0 开始新增

                                        //这里还可以做一些 append 文件列表 DOM 的操作

                                        //obj.upload(index, file); //对上传失败的单个文件重新上传，一般在某个事件中使用
                                        //delete files[index]; //删除列表中对应的文件，一般在某个事件中使用
                                    });
                                }
                                , done: function (res) {
                                    //如果上传失败
                                    if (res.code != 0) {
                                        return top.layer.msg('上传失败');
                                    }
                                    //上传成功
                                    if (res && res.code == 0) {
                                        top.layer.msg('上传成功');
                                        var filename = localStorage.getItem("filename");
                                        var planFileId = "planFileId_" + parseInt(Math.random() * 1000000) + new Date().getTime();
                                        $('#' + planContainerId).append("<div id='" + planFileId + "'>" + filename + "&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:delCompanyPaln('" + planFileId + "','" + res.data + "')\">删除</a></div>");
                                        var impCompanyPlanRelations = data.impCompanyPlanRelations;
                                        if (impCompanyPlanRelations == null || impCompanyPlanRelations == undefined) {
                                            impCompanyPlanRelations = new Array();
                                        }
                                        impCompanyPlanRelations.push({
                                            rectificationPlanId: res.data,
                                            companyId: data.impCompanyOtherInfo.companyId,
                                            fileName: filename,
                                        })
                                        data.bindImpCompanyPlanRelations = impCompanyPlanRelations;
                                    }
                                }
                                , error: function () {
                                    top.layer.msg('上传失败');
                                }
                            });
                            Object.defineProperty(data, "bindImpCompanyPlanRelations", {
                                get: function () {
                                    return this.impCompanyPlanRelations;
                                },
                                set: function (val) {
                                    this.impCompanyPlanRelations = val;
                                }
                            });
                            // for (var index in photoIds) {
                            //     if (isNaN(index) == false) {
                            //         layer.photos({
                            //             photos: "#" + photoIds[index],
                            //             anim: 5,

                            //         });
                            //     }
                            // }
                            form.render();
                            element.render();
                        });
                    } else {
                        parent.layer.msg("获取数据失败");
                    }
                },
                error: function () {
                    return parent.layer.msg("获取数据失败");
                }
            });
        }
        //点击图片放大
        $(document).on("click", ".layui-upload img", function(e){
            layer.photos({ photos: {"data": [{"src": e.target.src}]} });
        });

        //头部关闭按钮
        $("#cancelbtn").click(function () {
            // 关闭顶层框架tab
            var id = self.frameElement.getAttribute("tab-id");
            top.element.tabDelete('xbs_tab', id);
        });
        //底部关闭按钮
        $("#cancelbtn1").click(function () {
            // 关闭顶层框架tab
            var id = self.frameElement.getAttribute("tab-id");
            top.element.tabDelete('xbs_tab', id);
        });
        //保存按钮
        $("#imporveBtn").click(function () {
            //console.log(JSON.stringify(companyDtoInfo))
            $.ajax({
                type: 'POST',
                dataType: 'json',
                contentType: 'application/json',
                url: apiPath + '/company/impCompanyInfo/improve',
                data: JSON.stringify(companyDtoInfo),
                success: function (res) {
                    if (res && res.code == 0) {
                        top.layer.msg('编辑成功');
                        var src = $(top.document).find("iframe[tab-id='" + fid + "']").attr("src");
                        $(top.document).find("iframe[tab-id='" + fid + "']").attr("src", src);
                        // 切换到对应到选项卡下
                        top.element.tabChange('xbs_tab', fid);
                        // 关闭顶层框架tab
                        var id = self.frameElement.getAttribute("tab-id");
                        top.element.tabDelete('xbs_tab', id);
                    } else {
                        top.layer.msg('编辑失败')
                    }
                }
            })
            // 关闭顶层框架tab
            // var id = self.frameElement.getAttribute("tab-id");
            // top.element.tabDelete('xbs_tab', id);
        });
    });

    function setWarningInfo(impIndustryFieldsReleaseTreeMainDto, industryContainer, companyInfo) {
        var warningSelId = "warningSel_" + parseInt(Math.random() * 100000) + new Date().getTime();
        var warningRadioId = "warningRadio_" + parseInt(Math.random() * 100000) + new Date().getTime();
        var mainWarningTypeTimeId = "mainWarningTypeTime_" + parseInt(Math.random() * 100000) + new Date().getTime();
        var warningTimeHtml = "<fieldset class=\"layui-elem-field\">\n" +
            "                            <legend>预警设置</legend>\n" +
            "                            <div class=\"layui-field-box\">\n" +
            "                               <span style='color: red;'>注：当企业有多个行业时，每个行业需单独配置，TAB切换到其他行业可配置其他行业预警时间.</span>\n" +
            "                               <table>\n" +
            "                                   <tr>" +
            "                                       <td style='padding: 5px;'>" +
            "                                           <div class=\"layui-form-item\">";
        if (impIndustryFieldsReleaseTreeMainDto.warningsType == "1") {
            warningTimeHtml += " <input type=\"radio\" lay-filter='" + warningRadioId + "' name=\"maiWarningsType\" value=\"1\" title=\"按行业\" checked>";
        } else {
            warningTimeHtml += " <input type=\"radio\" lay-filter='" + warningRadioId + "' name=\"maiWarningsType\" value=\"1\" title=\"按行业\">";
        }
        warningTimeHtml += "                                       </div></td>" +
            "                                       <td style='padding: 5px;'>" +
            "                                          <div class=\"layui-form-item\">\n" +
            "                                               <label class=\"layui-form-label\">预警等级</label>\n" +
            "                                               <div class=\"layui-input-inline\">\n" +
            "                                       <select id='" + warningSelId + "' lay-filter='" + warningSelId + "'>";
        for (var index in industryLevelOptions) {
            if (isNaN(index) == false) {
                warningTimeHtml += "<option value='" + industryLevelOptions[index].value + "'>" + industryLevelOptions[index].name + "</option>";
            }
        }
        var industryWaringTimeStrId = "industryWaringTimeStr_" + parseInt(Math.random() * 10000000) + new Date().getTime();
        var industryWaringTimeStr = "";
        if (impIndustryFieldsReleaseTreeMainDto.industryWaringTime) {
            industryWaringTimeStr = "预警时间：" + new Date(impIndustryFieldsReleaseTreeMainDto.industryWaringTime).format("yyyy/MM/dd");
        }
        warningTimeHtml += "                                       </select>\n" +
            "                                               </div>\n" +
            "                                          </div>" +
            "                                   </td>" +
            "                                   <td style='padding: 5px;'><div class=\"layui-form-item\" id='" + industryWaringTimeStrId + "'>" + industryWaringTimeStr + "</div></td>" +
            "                               </tr>" +
            "                               <tr>" +
            "                                   <td style='padding: 5px;'> <div class=\"layui-form-item\">";
        if (impIndustryFieldsReleaseTreeMainDto.warningsType == "2") {
            warningTimeHtml += " <input type=\"radio\" lay-filter='" + warningRadioId + "' name=\"maiWarningsType\" value=\"2\" title=\"自定义\" checked>";
        } else {
            warningTimeHtml += " <input type=\"radio\" lay-filter='" + warningRadioId + "' name=\"maiWarningsType\" value=\"2\" title=\"自定义\">";
        }
        warningTimeHtml += " </div></td>" +
            "                                   <td style='padding: 5px;'><div class=\"layui-form-item\">\n" +
            "                                               <label class=\"layui-form-label\">预警时间</label>\n" +
            "                                               <div class=\"layui-input-inline\"> <input type=\"text\" class=\"layui-input\" id=\"" + mainWarningTypeTimeId + "\" placeholder=\"yyyy-MM-dd HH:mm:ss\"></div></div></td>" +
            "                                   <td></td>" +
            "                               </tr>\n" +
            "                               </table>" +
            "                           </div>\n" +
            "                        </fieldset>";
        industryContainer.append($(warningTimeHtml));
        form.on('radio(' + warningRadioId + ')', function (data) {
            $("#" + industryWaringTimeStrId).html("");
            impIndustryFieldsReleaseTreeMainDto.bindWarningsType = data.value;
        });
        form.on('select(' + warningSelId + ')', function (data) {
            impIndustryFieldsReleaseTreeMainDto.bindIndustryLevel = data.value;
            var typeVal = $("input[name='maiWarningsType']:checked").val();
            if (typeVal == 1) {
                $("#" + industryWaringTimeStrId).html("");
                $.ajax({
                    url: apiPath + '/industry/impIndustryWarningInfo/getIndustryWarningTime/' + impIndustryFieldsReleaseTreeMainDto.industryFieldsId + '/' + data.value + '/' + companyInfo.firstSubmitTime,
                    type: 'get',
                    success: function (res) {
                        if (res && res.code == 0) {
                            $("#" + industryWaringTimeStrId).html("预警时间：" + new Date(res.data).format("yyyy-MM-dd"));
                            impIndustryFieldsReleaseTreeMainDto.bindIndustryWaringTime = res.data;
                        }
                    }
                });
            }
        });
        laydate.render({
            elem: '#' + mainWarningTypeTimeId
            , type: 'date'
            , done: function (value, date, endDate) {
                var start_date = new Date(date.year, date.month - 1, date.date, date.hours, date.minutes, date.seconds);
                var typeVal = $("input[name='maiWarningsType']:checked").val();
                if (typeVal == 2) {
                    $("#" + industryWaringTimeStrId).html("");
                    impIndustryFieldsReleaseTreeMainDto.bindIndustryWaringTime = start_date.getTime();
                }
            }
        });

        Object.defineProperty(impIndustryFieldsReleaseTreeMainDto, "bindWarningsType", {
            get: function () {
                return this.warningsType;
            },
            set: function (val) {
                this.warningsType = val;
            }
        });

        Object.defineProperty(impIndustryFieldsReleaseTreeMainDto, "bindIndustryWaringTime", {
            get: function () {
                return this.industryWaringTime;
            },
            set: function (val) {
                this.industryWaringTime = val;
            }
        });

        Object.defineProperty(impIndustryFieldsReleaseTreeMainDto, "bindIndustryLevel", {
            get: function () {
                return this.industryLevel;
            },
            set: function (val) {
                this.industryLevel = val;
            }
        });
    }

    //展示企业动态字段信息。
    function showDynField(companyInfo) {
        var dynFieldInfoTab = $("#dynFieldInfo");
        element.tabDelete("dynFieldInfo");
        //主行业信息
        var impIndustryFieldsReleaseTreeMainDto = companyInfo.impIndustryFieldsReleaseTreeMainDto;
        if (impIndustryFieldsReleaseTreeMainDto) {
            var tabTitle = impIndustryFieldsReleaseTreeMainDto.industryName;
            var impIndustryFieldsReleaseArr = impIndustryFieldsReleaseTreeMainDto.impIndustryFieldsRelease;
            var industryContainer = $("<div class=\"layui-tab-item\"></div>");
            $("#tabTitle").append("<li>" + tabTitle + "</li>");
            $("#tabContent").append(industryContainer);
            setWarningInfo(impIndustryFieldsReleaseTreeMainDto, industryContainer, companyInfo);

            //存储配置了前置字段属性的字段信息
            var fontFieldRefMap = new Map();
            //存储前置字段信息
            var fontFieldItemMap = new Map();
            var sysCompMap = new Map();
            for (var index in impIndustryFieldsReleaseArr) {
                genSysCompFieldInfos(impIndustryFieldsReleaseTreeMainDto, impIndustryFieldsReleaseArr[index], sysCompMap);
                genFontFieldInfos(impIndustryFieldsReleaseArr, impIndustryFieldsReleaseArr[index], fontFieldRefMap, fontFieldItemMap);
            }
            //console.log("---fontFieldRefMap----");
            //console.log(fontFieldRefMap);
            impIndustryFieldsReleaseTreeMainDto.fontFieldRefMap = fontFieldRefMap;
            //console.log("---fontFieldItemMap----");
            //console.log(fontFieldItemMap);
            impIndustryFieldsReleaseTreeMainDto.fontFieldItemMap = fontFieldItemMap;

            for (var index in impIndustryFieldsReleaseArr) {
                genFormItem(impIndustryFieldsReleaseArr[index], industryContainer, impIndustryFieldsReleaseTreeMainDto);
            }
            // industryContainer.empty();
            /* element.tabAdd('dynFieldInfo', {
                 title: tabTitle
                 , content: industryContainer.html() //支持传入html
                 , id: 'mainIndustryHtml'
             });
             industryContainer.empty();*/

        }
        //子行业信息
        var impIndustryFieldsReleaseTreeSubDto = companyInfo.impIndustryFieldsReleaseTreeSubDto;
        if (impIndustryFieldsReleaseTreeSubDto) {
            for (var index in  impIndustryFieldsReleaseTreeSubDto) {
                if (isNaN(index) == false) {
                    var tabTitle = impIndustryFieldsReleaseTreeSubDto[index].industryName;
                    var stuDto = impIndustryFieldsReleaseTreeSubDto[index];
                    var impIndustryFieldsReleaseArr = stuDto.impIndustryFieldsRelease;
                    var industryContainer = $("<div class=\"layui-tab-item\"></div>");
                    $("#tabContent").append(industryContainer);
                    $("#tabTitle").append("<li>" + tabTitle + "</li>");

                    setWarningInfo(impIndustryFieldsReleaseTreeSubDto[index], industryContainer, companyInfo);
                    //存储配置了前置字段属性的字段信息
                    var fontFieldRefMap = new Map();
                    //存储前置字段信息
                    var fontFieldItemMap = new Map();
                    var sysCompMap = new Map();
                    for (var index in impIndustryFieldsReleaseArr) {
                        genSysCompFieldInfos(stuDto, impIndustryFieldsReleaseArr[index], sysCompMap);
                        genFontFieldInfos(impIndustryFieldsReleaseArr, impIndustryFieldsReleaseArr[index], fontFieldRefMap, fontFieldItemMap);
                    }
                    ////console.log("---fontFieldRefMap----");
                    ////console.log(fontFieldRefMap);
                    stuDto.fontFieldRefMap = fontFieldRefMap;
                    ////console.log("---fontFieldItemMap----");
                    ////console.log(fontFieldItemMap);
                    stuDto.fontFieldItemMap = fontFieldItemMap;
                    if (impIndustryFieldsReleaseArr) {
                        for (var subIndex in impIndustryFieldsReleaseArr) {
                            genFormItem(impIndustryFieldsReleaseArr[subIndex], industryContainer, stuDto);
                        }
                    }
                }
            }
        }
        form.render();
        $("#dynFieldInfo li:first").click();
        element.render('tab')
    }

    var photoIds = new Array();


    //展示企业固定字段信息。
    function showBaseField(companyInfo) {
        var baseFieldInfo = $("#baseFieldInfo");
        baseFieldInfo.empty();
        var basicIndustryFieldsReleaseDto = companyInfo.basicIndustryFieldsReleaseDto;
        //存储配置了前置字段属性的字段信息
        var fontFieldRefMap = new Map();
        //存储前置字段信息
        var fontFieldItemMap = new Map();
        for (var index in basicIndustryFieldsReleaseDto) {
            genFontFieldInfos(basicIndustryFieldsReleaseDto, basicIndustryFieldsReleaseDto[index], fontFieldRefMap, fontFieldItemMap);
        }
        ////console.log("---fontFieldRefMap----");
        ////console.log(fontFieldRefMap);
        basicIndustryFieldsReleaseDto.fontFieldRefMap = fontFieldRefMap;
        ////console.log("---fontFieldItemMap----");
        ////console.log(fontFieldItemMap);
        basicIndustryFieldsReleaseDto.fontFieldItemMap = fontFieldItemMap;
        if (basicIndustryFieldsReleaseDto) {
            for (var index in basicIndustryFieldsReleaseDto) {
                genFormItem(basicIndustryFieldsReleaseDto[index], baseFieldInfo, basicIndustryFieldsReleaseDto);
            }
        }
    }


    //获取配置了前置字段属性的字段信息
    function genFontFieldInfos(impIndustryFieldsReleaseArr, fieldInfo, fontFieldRefMap, fontFieldItemMap) {
        if (fieldInfo.webId == undefined) {
            fieldInfo.webId = "id_" + parseInt(Math.random() * 100000) + new Date().getTime();
        }
        if (fieldInfo.columnNum && fieldInfo.columnNum == 1000000000000) {
            return;
        }
        if (fieldInfo && fontFieldRefMap) {
            ////console.log("---->")
            ////console.log(fieldInfo.frontFiled)
            if (fieldInfo.frontFiled && fieldInfo.frontFiled != "") {
                var configArr = fieldInfo.frontFiled.split(":");
                if (configArr && configArr.length > 0) {
                    var configId = configArr[0] + "";
                    var configVal = configArr[1];
                    var fontdConfigMap;
                    if (fieldInfo.columnNum) {
                        configId = configId + "_" + fieldInfo.columnNum;
                    }
                    if (fontFieldRefMap.has(configId) == false) {
                        fontdConfigMap = new Map();
                        fontFieldRefMap.set(configId, fontdConfigMap);
                    } else {
                        fontdConfigMap = fontFieldRefMap.get(configId);
                    }
                    if (fontdConfigMap) {
                        fontdConfigMap.set(fieldInfo.webId, {
                            webId: fieldInfo.webId,
                            val: configVal
                        });
                    }
                    let fontFieldItem = getObjFromIndustry(impIndustryFieldsReleaseArr, configArr[0], fieldInfo.columnNum);
                    if (fontFieldItem) {
                        fontFieldItemMap.set(configId, fontFieldItem);
                    }
                }
            }
            if (fieldInfo.fieldSecondProperties == "12" || fieldInfo.fieldSecondProperties == "13") {
                if (fieldInfo.childs && fieldInfo.childs.length > 0) {
                    var childs = fieldInfo.childs;
                    for (var index in childs) {
                        genFontFieldInfos(impIndustryFieldsReleaseArr, childs[index], fontFieldRefMap, fontFieldItemMap);
                    }
                }
            }
        }
    }

    //获取类型为"系统计算"的字段信息
    function genSysCompFieldInfos(industryObj, fieldInfo, sysCompMap) {
        if (fieldInfo && sysCompMap) {
            if (fieldInfo.webId == undefined) {
                fieldInfo.webId = "id_" + parseInt(Math.random() * 100000) + new Date().getTime();
            }
            if (fieldInfo.fieldSecondProperties == "14") {
                sysCompMap.set(fieldInfo.webId, fieldInfo);
                let formula = fieldInfo.formula;
                //通过正则表达式找出configId,规则是#55,那么55就是configid
                //#55*0.8
                let configReg = /[\#](\d)+/gi;

                let result = formula.match(configReg);
                var computeFieldSet = new Set();
                let formula1 = fieldInfo.formula;
                for (var i = 0; i < result.length; i++) {
                    var item = result[i]
                    if (item) {
                        var impIndustryFieldsReleaseArr = industryObj.impIndustryFieldsRelease;
                        for (let industryIndex in impIndustryFieldsReleaseArr) {
                            let res = getObjByConfigId(impIndustryFieldsReleaseArr[industryIndex], item.substring(1), fieldInfo.columnNum);
                            // //console.log("configid res---------")
                            // //console.log(res)
                            if (res) {
                                computeFieldSet.add(res);
                                let refCompFieldSet = res.refComputeFieldSet;
                                if (!refCompFieldSet) {
                                    refCompFieldSet = new Set();
                                    res.refComputeFieldSet = refCompFieldSet;
                                }
                                refCompFieldSet.add(fieldInfo);
                                formula1 = formula1.replace(item, res.webId);
                            }
                        }
                    }
                }
                fieldInfo.computeFieldSet = computeFieldSet;
                fieldInfo.formula1 = formula1;

            }
            if (fieldInfo.fieldSecondProperties == "12" || fieldInfo.fieldSecondProperties == "13") {
                if (fieldInfo.childs && fieldInfo.childs.length > 0) {
                    var childs = fieldInfo.childs;
                    for (let childIndex in childs) {
                        genSysCompFieldInfos(industryObj, childs[childIndex], sysCompMap);
                    }
                }
            }
        }
    }

    //获取系统计算公式中#xx对应的字段信息
    function getObjFromIndustry(impIndustryFieldsReleaseArr, configId, columnNum) {
        if (impIndustryFieldsReleaseArr && configId) {
            // var impIndustryFieldsReleaseArr = industryObj.impIndustryFieldsRelease;
            for (var index in impIndustryFieldsReleaseArr) {
                let fieldInfo = impIndustryFieldsReleaseArr[index]
                if (fieldInfo.configId == parseInt(configId) && (!fieldInfo.columnNum || (fieldInfo.columnNum != 1000000000000 && fieldInfo.columnNum == columnNum))) {
                    return fieldInfo;
                }
                if (fieldInfo.fieldSecondProperties == "12" || fieldInfo.fieldSecondProperties == "13") {
                    if (fieldInfo.childs && fieldInfo.childs.length > 0) {
                        var childs = fieldInfo.childs;
                        for (let childIndex in childs) {
                            var res = getObjByConfigId(childs[childIndex], configId, columnNum);
                            if (res) {
                                return res;
                            }
                        }
                    }
                }
            }
        }
    }

    //获取系统计算公式中#xx对应的字段信息
    function getObjByConfigId(fieldInfo, configId, columnNum) {
        if (fieldInfo && configId) {
            if (fieldInfo.configId == parseInt(configId) && (!fieldInfo.columnNum || (fieldInfo.columnNum != 1000000000000 && fieldInfo.columnNum == columnNum))) {
                return fieldInfo;
            }
            if (fieldInfo.fieldSecondProperties == "12" || fieldInfo.fieldSecondProperties == "13") {
                if (fieldInfo.childs && fieldInfo.childs.length > 0) {
                    var childs = fieldInfo.childs;
                    for (let childIndex in childs) {
                        var res = getObjByConfigId(childs[childIndex], configId, columnNum);
                        if (res) {
                            return res;
                        }
                    }
                }
            }
        }
    }

    //计算系统计算
    function compSystemVal(fieldInfo) {
        let compVal = "";
        var formula1 = fieldInfo.formula1;
        if (fieldInfo.formula1) {
            let computeFieldSet = fieldInfo.computeFieldSet;
            for (let item of computeFieldSet.values()) {
                let fieldVal = 0;
                if (item.fieldData) {
                    fieldVal = item.fieldData;
                }
                formula1 = formula1.replace(item.webId, fieldVal);
            }
        }
        try {
            compVal = eval(formula1);
        } catch (e) {
            return 0;
        }
        return compVal;
    }

    function genFormItem(fieldInfo, container, industryObj) {
        if (fieldInfo && container) {
            var dis = "";
            if (fieldInfo.columnNum == 1000000000000 || (fieldInfo.fieldSecondProperties == "13" && (fieldInfo.columnNum == undefined || fieldInfo.columnNum == null || fieldInfo.columnNum == ""))) {
                dis = "display: none;";
            } else if (fieldInfo.frontFiled != undefined && fieldInfo.frontFiled.length > 0) {
                var fontArray = fieldInfo.frontFiled.split(":");
                let configId = fontArray[0];
                var configVal = fontArray[1];
                //console.log("------1------------->")
                //console.log(fieldInfo)
                //console.log(configId)
                //console.log(configVal)
                //console.log(industryObj)

                if (fieldInfo.columnNum) {
                    configId = configId + "_" + fieldInfo.columnNum;
                }
                var checkedVal = new Array();
                if (configId && industryObj && industryObj.fontFieldItemMap) {
                    //console.log("------22222------------->")
                    var fontItem = industryObj.fontFieldItemMap.get(configId + "");
                    //console.log(fontItem)
                    var fontVal = "";
                    // var fontFieldRefMap=industryObj.fontFieldRefMap;
                    //console.log("fieldSecondProperties----------------")
                    //console.log(fieldInfo.fieldSecondProperties)
                    if (fontItem) {
                        if (fontItem.fieldSecondProperties == "6" || fontItem.fieldSecondProperties == "7" || fontItem.fieldSecondProperties == "8" || fontItem.fieldSecondProperties == "9") {
                            var fontCheckArr = new Array();
                            if (fontItem.fieldData) {
                                fontCheckArr = fontItem.fieldData.split(",");
                            }
                            //console.log("------333333------------->")
                            //console.log(fontCheckArr)
                            if (fontItem.options) {
                                var dataArr = fontItem.options.split(",");
                                //console.log(dataArr)
                                for (var index in dataArr) {
                                    //console.log(index)
                                    if (isNaN(index) == false) {
                                        //console.log(fontCheckArr.indexOf(index + ""))
                                        if (fontCheckArr.indexOf(index + "") > -1) {
                                            checkedVal.push(dataArr[index]);
                                        }
                                    }
                                }
                            }
                            //console.log("---checkedVal--------")
                            //console.log(checkedVal.join(","))
                            //  fontVal = checkedVal.join(",");
                        } else {
                            // fontVal=fontItem.fieldData;
                            checkedVal.push(fontItem.fieldData);
                        }
                        if (fontItem.fieldSecondProperties == "7" || fontItem.fieldSecondProperties == "9") {
                            if (fontItem.otherData && fontItem.otherData.length > 0) {
                                // fontVal+=","+fieldInfo.otherData;
                                // fontVal += fieldInfo.otherData;
                                // checkedVal.push(fieldInfo.otherData);
                                checkedVal.push("其他");
                            }
                        }
                    }
                    if (checkedVal.indexOf(configVal) > -1) {
                        dis = "";
                    } else {
                        dis = "display: none;";
                    }
                    // fieldSecondProperties
                }
            }
            //console.log("dis--------" + dis)
            let configId= fieldInfo.configId + "";
            if(fieldInfo.columnNum){
                configId=configId+"_"+fieldInfo.columnNum;
            }
            var fieldId = "f_" + fieldInfo.webId;
            if (fieldInfo.fieldSecondProperties == "0") {
                // DWBSR(0,"短文本输入")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item\"> \n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                       <input id='" + fieldId + "'   autocomplete=\"off\" class=\"layui-input\" value='" + fieldInfo.fieldData + "'>\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select  id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                });

                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                })
                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                Object.defineProperty(companyDtoInfo, "bindBindComapnyName", {
                    configurable: true,
                    get: function () {
                        return this.companyName;
                    },
                    set: function (val) {
                        this.companyName = val;
                    }
                })
                $("#" + fieldId).on("input", function (e) {
                    fieldInfo.bindData = this.value;
                    if (fieldInfo.fieldName == "企业名称" && fieldInfo.type == 2) {
                        companyDtoInfo.bindBindComapnyName = this.value;
                    }
                    var checkVal = this.value;
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                })
                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                });

            } else if (fieldInfo.fieldSecondProperties == "1") {
                // SJHSR(1,"11号手机号输入")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                       <input   data-id='' id='" + fieldId + "' lay-verify='phone'  autocomplete=\"off\" class=\"layui-input\" value='" + fieldInfo.fieldData + "'>\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                $("#" + fieldId).on("input", function (e) {
                    fieldInfo.bindData = this.value;
                    var checkVal = this.value;
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                })
                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });

            } else if (fieldInfo.fieldSecondProperties == "2") {
                // SZSR(2,"数字输入")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                       <input   data-id='' id='" + fieldId + "' lay-verify='number'  autocomplete=\"off\" class=\"layui-input\" value='" + fieldInfo.fieldData + "'>\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    // //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });

                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    // //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                $("#" + fieldId).on("input", function (e) {
                    fieldInfo.bindData = this.value;
                    var checkVal = this.value;
                    if (fieldInfo.refComputeFieldSet) {
                        for (let refItem of fieldInfo.refComputeFieldSet.values()) {
                            let resVal = compSystemVal(refItem);
                            $("#f_" + refItem.webId).val(resVal);
                        }
                    }
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                })

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "3") {
                // CWBSR(3,"长文本输入")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                       <textarea   data-id='' id='" + fieldId + "'   autocomplete=\"off\" class=\"layui-textarea\">" + fieldInfo.fieldData + "</textarea>\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";

                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    // //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    // //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    configurable: true,
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                $("#" + fieldId).on("input", function (e) {
                    fieldInfo.bindData = this.value;
                    var checkVal = this.value;
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                    // //console.log(fieldInfo)
                })

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "4") {
                //  RQXZ(4,"日期选择(年月日)")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                        <input type=\"text\" class=\"layui-input\" id=\"" + fieldId + "\">\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    // //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                var option = {
                    elem: '#' + fieldId
                    , done: function (value, date, endDate) {
                        var start_date = new Date(date.year, date.month - 1, date.date, date.hours, date.minutes, date.seconds);
                        fieldInfo.bindData = start_date.getTime();
                        var checkVal = start_date.getTime();
                        if (industryObj && industryObj.fontFieldRefMap) {
                            var fontFieldRefMap = industryObj.fontFieldRefMap;
                            if (fontFieldRefMap.has(configId)) {
                                var childsItmes = fontFieldRefMap.get(configId);
                                childsItmes.forEach(function (value, key) {
                                    if (checkVal === value.val) {
                                        $("#" + key).show();
                                    } else {
                                        $("#" + key).hide();
                                    }
                                });
                            }
                        }
                        //console.log(fieldInfo)
                    }
                };
                if (fieldInfo.fieldData) {
                    option.value = new Date(parseInt(fieldInfo.fieldData));
                }
                laydate.render(option);

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });

            } else if (fieldInfo.fieldSecondProperties == "5") {
                // SJXZ(5,"时间选择(年月日时分秒)")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                        <input type=\"text\" class=\"layui-input\" id=\"" + fieldId + "\">\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })

                var option = {
                    elem: '#' + fieldId
                    , type: 'datetime'
                    , done: function (value, date, endDate) {
                        var start_date = new Date(date.year, date.month - 1, date.date, date.hours, date.minutes, date.seconds);
                        fieldInfo.bindData = start_date.getTime();
                        var checkVal = start_date.getTime();
                        if (industryObj && industryObj.fontFieldRefMap) {
                            var fontFieldRefMap = industryObj.fontFieldRefMap;
                            if (fontFieldRefMap.has(configId)) {
                                var childsItmes = fontFieldRefMap.get(configId);
                                childsItmes.forEach(function (value, key) {
                                    if (checkVal === value.val) {
                                        $("#" + key).show();
                                    } else {
                                        $("#" + key).hide();
                                    }
                                });
                            }
                        }
                        //console.log(fieldInfo)
                    }
                };
                if (fieldInfo.fieldData) {
                    option.value = new Date(parseInt(fieldInfo.fieldData));
                }
                laydate.render(option);

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });

            } else if (fieldInfo.fieldSecondProperties == "6") {
                // DX(6,"单选")
                var checkArr = new Array();
                if (fieldInfo.fieldData) {
                    checkArr = fieldInfo.fieldData.split(",");
                }
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n";
                var checkedVal = new Array();
                if (fieldInfo.options) {
                    var dataArr = fieldInfo.options.split(",");
                    for (var index in dataArr) {
                        if (isNaN(index) == false) {
                            if (checkArr.indexOf(index) > -1) {
                                checkedVal.push2(dataArr[index]);
                                itemHtml += "<input type=\"radio\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\" checked>";
                            } else {
                                itemHtml += "<input type=\"radio\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\" >";
                            }
                        }
                    }
                }
                itemHtml += "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));


                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });

                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                form.on('radio(' + fieldId + ')', function (data) {
                    fieldInfo.bindData = data.value;
                    checkedVal.push2($(data.elem).attr("title"));
                    var checkVal = $(data.elem).attr("title");
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                    //console.log("-------------")
                    //console.log(fieldInfo)
                });

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "7") {
                // DXQT(7,"单选(其他)")
                var checkArr = new Array();
                if (fieldInfo.fieldData) {
                    checkArr = fieldInfo.fieldData.split(",");
                }
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n";
                var checkedVal = new Array();
                if (fieldInfo.options) {
                    var dataArr = fieldInfo.options.split(",");
                    for (var index in dataArr) {
                        if (isNaN(index) == false) {
                            if (checkArr.indexOf(index) > -1) {
                                checkedVal.push2(dataArr[index]);
                                itemHtml += "<input type=\"radio\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\" checked>";
                            } else {
                                itemHtml += "<input type=\"radio\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\">";
                            }
                        }
                    }
                }
                if (fieldInfo.otherData) {
                    itemHtml += "<input type=\"radio\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" checked value=\"其他\" title=\"其他\">";
                    itemHtml += "<input type=\"input\" id=\"other_" + fieldId + "\" value='" + fieldInfo.otherData + "' >";
                } else {
                    itemHtml += "<input type=\"radio\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"其他\" title=\"其他\">";
                    itemHtml += "<input type=\"input\" id=\"other_" + fieldId + "\" style='display: none;' >";
                }
                itemHtml += "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindOtherData", {
                    get: function () {
                        return this.otherData;
                    },
                    set: function (val) {
                        this.otherData = val;
                    }
                })
                $("#other_" + fieldId).on("input", function (e) {
                    fieldInfo.bindOtherData = this.value;
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var checkVal = this.value;
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                })
                form.on('radio(' + fieldId + ')', function (data) {
                    fieldInfo.bindData = data.value;
                    if (data.value == "其他") {
                        $("#other_" + fieldId).show();
                        if (industryObj && industryObj.fontFieldRefMap) {
                            var fontFieldRefMap = industryObj.fontFieldRefMap;
                            if (fontFieldRefMap.has(configId)) {
                                let checkStr=data.value
                                var childsItmes = fontFieldRefMap.get(configId);
                                let showOrHide=data.elem.checked;
                                childsItmes.forEach(function (value, key) {
                                    if (checkStr === value.val) {
                                        if(showOrHide){
                                            $("#" + key).show();
                                        } else {
                                            $("#" + key).hide();
                                        }
                                    }
                                });

                            }
                        }
                    } else {
                        $("#other_" + fieldId).hide();
                        if (industryObj && industryObj.fontFieldRefMap) {
                            var fontFieldRefMap = industryObj.fontFieldRefMap;
                            if (fontFieldRefMap.has(configId)) {
                                let dataVal=data.value;
                                if (fieldInfo.options) {
                                    let optionsArr = fieldInfo.options.split(",");
                                    let checkStr=optionsArr[dataVal];
                                    var childsItmes = fontFieldRefMap.get(configId);
                                    let showOrHide=data.elem.checked;
                                    childsItmes.forEach(function (value, key) {
                                        if (checkStr === value.val) {
                                            if(showOrHide){
                                                $("#" + key).show();
                                            } else {
                                                $("#" + key).hide();
                                            }
                                        }
                                    });
                                }

                            }
                        }
                    }
                });

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });

            } else if (fieldInfo.fieldSecondProperties == "8") {
                // DXX(8,"多选")
                var checkArr = new Array();
                if (fieldInfo.fieldData) {
                    checkArr = fieldInfo.fieldData.split(",");
                }
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n";
                var checkedVal = new Array();
                if (fieldInfo.options) {
                    var dataArr = fieldInfo.options.split(",");
                    for (var index in dataArr) {
                        if (isNaN(index) == false) {
                            if (checkArr.indexOf(index) > -1) {
                                checkedVal.push2(dataArr[index]);
                                itemHtml += "<input type=\"checkbox\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\" checked>";
                            } else {
                                itemHtml += "<input type=\"checkbox\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\">";
                            }
                        }
                    }
                }
                itemHtml += "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));
                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                form.on('checkbox(' + fieldId + ')', function (data) {
                    var chk_value = [];
                    var chk_value2 = [];
                    $('input[name="' + fieldId + '"]:checked').each(function () {
                        chk_value.push($(this).val());
                        chk_value2.push($(this).attr("title"));
                    });
                    fieldInfo.bindData = chk_value.join(",");
                    checkedVal = chk_value2;

                    var checkVal = chk_value.join(",");
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            if (fieldInfo.options) {
                                let optionsArr = fieldInfo.options.split(",");
                                let checkStr=optionsArr[dataVal];
                                var childsItmes = fontFieldRefMap.get(configId);
                                let showOrHide=data.elem.checked;
                                childsItmes.forEach(function (value, key) {
                                    if (checkStr === value.val) {
                                        if(showOrHide){
                                            $("#" + key).show();
                                        } else {
                                            $("#" + key).hide();
                                        }
                                    }
                                });
                            }
                        }
                    }
                });

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "9") {
                // DXXQT(9,"多选(其他)")
                var checkArr = new Array();
                if (fieldInfo.fieldData) {
                    checkArr = fieldInfo.fieldData.split(",");
                }
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n";
                var checkedVal = new Array();
                if (fieldInfo.options) {
                    var dataArr = fieldInfo.options.split(",");
                    for (var index in dataArr) {
                        if (isNaN(index) == false) {
                            if (checkArr.indexOf(index) > -1) {
                                checkedVal.push2(dataArr[index]);
                                itemHtml += "<input type=\"checkbox\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\" checked>";
                            } else {
                                itemHtml += "<input type=\"checkbox\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"" + index + "\" title=\"" + dataArr[index] + "\">";
                            }
                        }
                    }
                }
                if (fieldInfo.otherData) {
                    itemHtml += "<input type=\"checkbox\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"其他\" title=\"其他\" checked>";
                    itemHtml += "<input type=\"input\" id=\"other_" + fieldId + "\" value='" + fieldInfo.otherData + "'>";
                } else {
                    itemHtml += "<input type=\"checkbox\" name=\"" + fieldId + "\" lay-filter=\"" + fieldId + "\" value=\"其他\" title=\"其他\">";
                    itemHtml += "<input type=\"input\" id=\"other_" + fieldId + "\" style='display: none;' >";
                }
                itemHtml += "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(checkedVal.join(",")) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                Object.defineProperty(fieldInfo, "bindOtherData", {
                    get: function () {
                        return this.otherData;
                    },
                    set: function (val) {
                        this.otherData = val;
                    }
                })
                $("#other_" + fieldId).on("input", function (e) {
                    fieldInfo.bindOtherData = this.value;
                    var checkVal = this.value;
                    if (industryObj && industryObj.fontFieldRefMap) {
                        var fontFieldRefMap = industryObj.fontFieldRefMap;
                        if (fontFieldRefMap.has(configId)) {
                            var childsItmes = fontFieldRefMap.get(configId);
                            childsItmes.forEach(function (value, key) {
                                if (checkVal === value.val) {
                                    $("#" + key).show();
                                } else {
                                    $("#" + key).hide();
                                }
                            });
                        }
                    }
                })
                form.on('checkbox(' + fieldId + ')', function (data) {
                    var chk_value = [];
                    var chk_value2 = [];
                    $('input[name="' + fieldId + '"]:checked').each(function () {
                        chk_value.push($(this).val());
                        chk_value2.push($(this).attr("title"));
                    });
                    fieldInfo.bindData = chk_value.join(",");
                    checkedVal = chk_value2;
                    if (data.value == "其他") {
                        if (data.elem.checked) {
                            $("#other_" + fieldId).show();
                        } else {
                            $("#other_" + fieldId).hide();
                        }
                    }else{
                        if (industryObj && industryObj.fontFieldRefMap) {
                            var fontFieldRefMap = industryObj.fontFieldRefMap;
                            if (fontFieldRefMap.has(configId)) {
                                let dataVal=data.value;
                                if (fieldInfo.options) {
                                    let optionsArr = fieldInfo.options.split(",");
                                    let checkStr=optionsArr[dataVal];
                                    var childsItmes = fontFieldRefMap.get(configId);
                                    let showOrHide=data.elem.checked;
                                    childsItmes.forEach(function (value, key) {
                                        if (checkStr === value.val) {
                                            if(showOrHide){
                                                $("#" + key).show();
                                            } else {
                                                $("#" + key).hide();
                                            }
                                        }
                                    });
                                }
                            }
                        }
                    }
                });

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "10") {
                // SCDT(10,"上传图片")
                var imagePath = "";
                if (fieldInfo.fieldData) {
                    imagePath = apiPath + "/attached/show/" + fieldInfo.fieldData;
                }
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-upload layui-input-block\">\n" +
                    "                       <button type=\"button\" class=\"layui-btn\" id=\"upload_" + fieldId + "\">图片上传</button> \n" +
                    "                       <div class=\"layui-upload-list\" style='text-align: center;'>\n" +
                    "                           <img class=\"layui-upload-img\" style='width: 60px;height: 60px;' id=\"img_view_" + fieldId + "\"  layer-src = \"" + imagePath + "\" layer-pid src=\"" + imagePath + "\">\n" +
                    "                           <p id=\"msgText_" + fieldId + "\"></p>\n" +
                    "                       </div>" +
                    "                   </div>" +
                    "               </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                var uploadInst = upload.render({
                    elem: '#upload_' + fieldId
                    , url: apiPath + '/attached/file_upload' //改成您自己的上传接口
                    , before: function (obj) {
                        //预读本地文件示例，不支持ie8
                        obj.preview(function (index, file, result) {
                            $('#img_view_' + fieldId).attr('src', result); //图片链接（base64）
                        });
                    }
                    , done: function (res) {
                        //如果上传失败
                        if (res.code > 0) {
                            return top.layer.msg('上传失败');
                        }
                        //上传成功
                        if (res && res.code == 0) {
                            top.layer.msg('上传成功');
                            var aid = fieldId + parseInt(Math.random() * 100000);
                            $('#img_view_' + fieldId).attr("src", apiPath + "/attached/show/" + res.data);
                            fieldInfo.bindData = res.data;
                        }
                    }
                    , error: function () {
                        top.layer.msg('上传失败');
                    }
                });

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "11") {
                // SCTPBX(11,"上传图片（不限）")
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item layui-form-text\">\n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-upload layui-input-block\">\n" +
                    "                       <button type=\"button\" class=\"layui-btn\" id=\"upload_" + fieldId + "\">图片上传</button> \n" +
                    "                       <div class=\"layui-upload-list\" id=\"img_view_" + fieldId + "\">\n" +
                    "                       </div>" +
                    "                   </div>" +
                    "              </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));
                if (fieldInfo.fieldData) {
                    var imageIds = fieldInfo.fieldData.split(",");
                    for (var imageIndex in imageIds) {
                        if (isNaN(imageIndex) == false) {
                            var aid = fieldId + parseInt(Math.random() * 100000);
                            $('#img_view_' + fieldId).append(" <div style='text-align: center;'><img style='width: 60px;height: 60px;' layer-src = \"" + apiPath + "/attached/show/" + imageIds[imageIndex] + "\" layer-pid src=\"" + apiPath + "/attached/show/" + imageIds[imageIndex] + "\" alt=\"\"><br/><a id='" + aid + "' href='javascript:void(0)'  data-fileuploadid='" + imageIds[imageIndex] + "' style='color: blue;'>删除</a></div>\n");
                            $("#" + aid).on("click", function (e) {
                                $(this).parent().remove();
                                var chk_value = [];
                                $('#img_view_' + fieldId).find("a").each(function () {
                                    chk_value.push($(this).attr("data-fileuploadid"));
                                });
                                fieldInfo.bindData = chk_value.join(",");
                                //console.log("上传del------->")
                                //console.log("上传del------->")
                                //console.log(fieldInfo)
                            })
                        }
                    }
                }

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                    //console.log(fieldInfo)
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                var uploadInst = upload.render({
                    elem: '#upload_' + fieldId
                    , multiple: true
                    , url: apiPath + '/attached/file_upload' //改成您自己的上传接口
                    , before: function (obj) {
                        //预读本地文件示例，不支持ie8
                        obj.preview(function (index, file, result) {
                        });
                    }
                    , done: function (res) {
                        //如果上传失败
                        if (res.code > 0) {
                            return top.layer.msg('上传失败');
                        }
                        //上传成功
                        if (res && res.code == 0) {
                            top.layer.msg('上传成功');
                            var aid = fieldId + parseInt(Math.random() * 100000);
                            $('#img_view_' + fieldId).append(" <div style='text-align: center;'><img style='width: 60px;height: 60px;' layer-src = \"" + apiPath + "/attached/show/" + res.data + "\" layer-pid src=\"" + apiPath + "/attached/show/" + res.data + "\" alt=\"\"><br/><a id='" + aid + "' href='javascript:void(0)'  data-fileuploadid='" + res.data + "' style='color: blue;'>删除</a></div>\n");
                            $("#" + aid).on("click", function (e) {
                                $(this).parent().remove();
                                var chk_value = [];
                                $('#img_view_' + fieldId).find("a").each(function () {
                                    chk_value.push($(this).attr("data-fileuploadid"));
                                });
                                fieldInfo.bindData = chk_value.join(",");
                                //console.log("上传del------->")
                                //console.log("上传del------->")
                                //console.log(fieldInfo)
                            })
                        }
                    }
                    , error: function () {
                        top.layer.msg('上传失败');
                    }
                });

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            } else if (fieldInfo.fieldSecondProperties == "12") {
                // LMBT(12,"栏目标题")
                var itemHtml = "<fieldset class=\"layui-elem-field\" id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "                            <legend>" + fieldInfo.fieldName + "</legend>\n" +
                    "                            <div class=\"layui-field-box\">\n" +
                    "                            </div>\n" +
                    "                        </fieldset>";
                var itemHtmlObj = $(itemHtml)
                container.append(itemHtmlObj);
                if (fieldInfo.childs && fieldInfo.childs.length > 0) {
                    var childs = fieldInfo.childs;
                    for (var index in childs) {
                        if (isNaN(index) == false) {
                            genFormItem(childs[index], itemHtmlObj.find(".layui-field-box").first(), industryObj);
                        }
                    }
                }
                return itemHtmlObj;

            } else if (fieldInfo.fieldSecondProperties == "13") {
                // LMBTZ(13,"栏目标题组")
                var itemHtml = "<fieldset class=\"layui-elem-field\" id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "                            <legend>" + fieldInfo.fieldName + "</legend>\n" +
                    "                            <div class=\"layui-field-box\">\n" +
                    "                            </div>\n" +
                    "                        </fieldset>";
                var itemHtmlObj = $(itemHtml)
                container.append(itemHtmlObj);
                if (fieldInfo.childs && fieldInfo.childs.length > 0) {
                    var childs = fieldInfo.childs;
                    for (var index in childs) {
                        if (isNaN(index) == false) {
                            genFormItem(childs[index], itemHtmlObj.find(".layui-field-box").first(), industryObj);
                        }
                    }
                }
                return itemHtmlObj;

            } else if (fieldInfo.fieldSecondProperties == "14") {
                // XTJS(14,"系统计算")
                if (fieldInfo.columnNum && fieldInfo.columnNum == 1000000000000) {
                    return;
                }
                let compVal = compSystemVal(fieldInfo);
                var itemHtml = "<table width='100%' id='" + fieldInfo.webId + "' style='" + dis + "'>\n" +
                    "        <tr>\n" +
                    "            <td width=\"50%\">" +
                    "              <div class=\"layui-form-item\"> \n" +
                    "                   <label class=\"layui-form-label\">" + fieldInfo.fieldName + "</label>\n" +
                    "                   <div class=\"layui-input-block\">\n" +
                    "                       <input   data-id='' id='" + fieldId + "'   autocomplete=\"off\" class=\"layui-input\" value='" + compVal + "'>\n" + getDisStr1(fieldInfo.unit) + "&nbsp;&nbsp;" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "            <td width=\"50%\">" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">违规等级</label>\n" +
                    "                   <div class=\"layui-input-inline\">\n" +
                    "                       <select id='level_" + fieldId + "' lay-filter='level_" + fieldId + "'>";
                itemHtml += "<option value='' >请选择</option>";
                for (var index in levelOptions) {
                    if (isNaN(index) == false) {
                        itemHtml += "<option value='' >请选择</option>";
                        if (levelOptions[index].value === parseInt(fieldInfo.violationLevel)) {
                            itemHtml += "<option value='" + levelOptions[index].value + "' selected>" + levelOptions[index].name + "</option>";
                        } else {
                            itemHtml += "<option value='" + levelOptions[index].value + "'>" + levelOptions[index].name + "</option>";
                        }
                    }
                }
                var policiesBtn = "policies_btn_" + fieldId + parseInt(Math.random() * 100000);
                var planBtn = "plan_btn_" + fieldId + parseInt(Math.random() * 100000);
                itemHtml += "</select>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">政策法规</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + policiesBtn + "' value='" + (fieldInfo.policiesId == undefined ? "" : fieldInfo.policiesId) + "'><a id='a_" + policiesBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "               <div class=\"layui-inline\">\n" +
                    "                   <label class=\"layui-form-label\">整改方案</label>\n" +
                    "                   <div class=\"layui-input-inline imp-item\">\n" +
                    "                       <input type='hidden' id='" + planBtn + "'><a id='a_" + planBtn + "' href='javascript:void(0)'>设置</a>\n" +
                    "                   </div>\n" +
                    "                </div>" +
                    "            </td>\n" +
                    "        </tr>\n" +
                    "    </table>";
                container.append($(itemHtml));

                Object.defineProperty(fieldInfo, "bindRectificationId", {
                    get: function () {
                        return this.rectificationId;
                    },
                    set: function (val) {
                        this.rectificationId = val;
                    }
                })
                $("#" + planBtn).on("click", function (e) {
                    fieldInfo.bindRectificationId = this.value;
                    //console.log(fieldInfo)
                })
                $("#a_" + planBtn).on("click", function (e) {
                    var planBtnVal = $("#" + planBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择整改方案',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "planFieldsRelation-list.html?planBtn=" + planBtn + "&id=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&plans=" + planBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                });
                Object.defineProperty(fieldInfo, "bindData", {
                    get: function () {
                        return this.fieldData;
                    },
                    set: function (val) {
                        this.fieldData = val;
                    }
                })
                $("#" + fieldId).on("input", function (e) {
                    fieldInfo.bindData = this.value;
                })
                Object.defineProperty(fieldInfo, "bindPolicyId", {
                    get: function () {
                        return this.policiesId;
                    },
                    set: function (val) {
                        this.policiesId = val;
                    }
                })
                $("#" + policiesBtn).on("click", function (e) {
                    fieldInfo.bindPolicyId = this.value;
                })

                $("#a_" + policiesBtn).on("click", function (e) {
                    var policiesBtnVal = $("#" + policiesBtn).val();
                    var index = layer.open({
                        type: 2,
                        skin: 'layui-layer-demo', //样式类名
                        title: '选择法规条例',
                        area: ['800px', '1000px'],
                        closeBtn: 1,
                        anim: 2,
                        maxmin: true,
                        shadeClose: true, //开启
                        content: "policies.html?policiesBtn=" + policiesBtn + "&industryFieldsId=" + fieldInfo.id + "&fieldName=" + encodeURI(fieldInfo.fieldName) + "&content=" + encodeURI(fieldInfo.fieldData) + "&policies=" + policiesBtnVal,//这里content是一个普通的String
                    });
                    layer.full(index);
                })

                Object.defineProperty(fieldInfo, "bindLevel", {
                    get: function () {
                        return this.violationLevel;
                    },
                    set: function (val) {
                        this.violationLevel = val;
                    }
                })
                form.on('select(level_' + fieldId + ')', function (data) {
                    fieldInfo.bindLevel = data.value;
                    // console.log(fieldInfo)
                });
            }
        }
        return container;
    }

    //展示公司基本信息
    function disComanyInfo(companyInfo) {
        var tbody = $("#companyInfo");
        var tblx = "-";
        if (companyInfo.type) {
            if (companyInfo.type == 1) {
                tblx = "勘察";
            } else if (companyInfo.type == 2) {
                tblx = "巡查";
            }
        }
        var auditStatusStr = "";
        if (companyInfo.auditStatus) {
            if (companyInfo.auditStatus == 0) {
                auditStatusStr = "待审核";
            } else if (companyInfo.auditStatus == 1) {
                auditStatusStr = "审核成功";
            } else if (companyInfo.auditStatus == 2) {
                auditStatusStr = "已驳回";
            } else if (companyInfo.auditStatus == 3) {
                auditStatusStr = "待更新";
            } else if (companyInfo.auditStatus == 4) {
                auditStatusStr = "已更新";
            } else if (companyInfo.auditStatus == 5) {
                auditStatusStr = "待完善";
            }
        }
        var firstSubmitTimeStr = "";
        if (companyInfo.firstSubmitTime) {
            firstSubmitTimeStr = new Date(companyInfo.firstSubmitTime).format("yyyy-MM-dd hh:mm:ss")
        }
        var trStr = "<tr>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">档案编号</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.fileNumber) +
            "                                </td>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">行业</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.industry) +
            "                                </td>\n" +
            "                            </tr>" +
            "<tr>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">提报类型</td>\n" +
            "                                <td width=\"35%\">\n" + tblx +
            "                                </td>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">归属预警</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.attributionWarning) +
            "                                </td>\n" +
            "                            </tr>" +
            "<tr>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">小组</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.team) +
            "                                </td>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">组员</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.teamSub) +
            "                                </td>\n" +
            "                            </tr>" +
            "<tr>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">技术员</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.technician) +
            "                                </td>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">提报时间</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(firstSubmitTimeStr) +
            "                                </td>\n" +
            "                            </tr>" +
            "<tr>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">区域</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.area) +
            "                                </td>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">整改状态</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.zgStatus) +
            "                                </td>\n" +
            "                            </tr>" +
            "<tr>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">整改方案</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(companyInfo.zgPlanStatus) +
            "                                </td>\n" +
            "                                <td width=\"15%\" class=\"base-info-title\">状态</td>\n" +
            "                                <td width=\"35%\">\n" + getDisStr(auditStatusStr) +
            "                                </td>\n" +
            "                            </tr>";
        tbody.append($(trStr));
    }

    function policyBtnClick(id, val) {
        //console.log(id)
        //console.log(val)
        $("#" + id).val(val);
        $("#" + id).click();
    }
</script>


</body>
</html>
